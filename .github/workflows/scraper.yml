name: Job Scraper

# This workflow commits the locally-scraped jobs.db to the repo.
# The scraper must be run locally because recruitment.nic.in blocks cloud IPs.
# Run locally: go run cmd/scraper/main.go
# Then: git add jobs.db metadata.json && git commit && git push

on:
  push:
    branches: [ "main" ]
    paths:
      - 'jobs.db'
      - 'metadata.json'
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Validate jobs.db
        run: |
          if [ ! -f jobs.db ]; then
            echo "❌ jobs.db not found"
            exit 1
          fi
          echo "✅ jobs.db exists ($(stat --format=%s jobs.db) bytes)"
          echo "✅ metadata.json:"
          cat metadata.json
